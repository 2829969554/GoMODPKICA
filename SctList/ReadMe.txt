crt文件：从互联网采集来的，仅学习参考

sct文件：签名证书时间戳列表的字节集数据
a.sct 从 a.crt文件中提取出来的
b.sct 从 b.crt文件中提取出来的
c.sct 从 c.crt文件中提取出来的

sct.go

本代码实现  SSL域名证书中的SCT列表   SCT签名证书列表 解析为可视化数据的功能

// SCT 代表一个 Signed Certificate Timestamp 的结构
type SCT struct {
	Raw	   	  []byte    //SCT结构体对应字节集
	SCTlenth  int       //当前子SCT长度
    Version   int       // SCT 版本  V1:0
    LogID     []byte    // 日志 ID  字节集长度32，字符串长度64
    Timestamp uint64 // 时间戳 13位数 精确到毫秒
    Hash int  //0:none 1:MD5  2:SHA1 3:SHA224 4:SHA256 5:SHA384 6:SHA512
    Signtype int //0:anonymous 1:RSA  2：DSA  3:ECDSA
    Signature []byte    // SCT 签名 ECDSA签名长度70，字符串长度140
}
此SCT编写了 Parse方法，用于解析现有字节集类型的子SCT节数据

//时间戳列表，一般包含3组数据，目前不支持2组数据解析
type SCTList struct{
	Raw			   []byte	//SCTList结构体对应字节集
	SCTListlenth   int 		//当前SCTList总长度
	SCTs		   []SCT 	//SCT数组
}
此SCTList编写了 Parse方法，用于解析现有字节集类型的SCT列表数据



实验效果:详见 sct.exe 输出如下

1.单独的SCT一节数据

0x75,0x00,0x12,0xF1,0x4E,0x34,0xBD,0x53,0x72,0x4C,0x84,0x06,0x19,0xC3,0x8F,0x3F,0x7A,0x13,0xF8,0xE7,0xB5,0x62,0x87,0x88,0x9C,0x6D,0x30,0x05,0x84,0xEB,0xE5,0x86,0x26,0x3A,0x00,0x00,0x01,0x91,0x44,0xA4,0xE4,0x5E,0x00,0x00,0x04,0x03,0x00,0x46,0x30,0x44,0x02,0x20,0x42,0xEE,0x56,0xF3,0x66,0x3B,0x32,0xA6,0xDD,0xF1,0x50,0x47,0x81,0xC2,0xF2,0x17,0x80,0x3D,0x5C,0x12,0x13,0x2F,0x4A,0x99,0x3F,0xE5,0x5F,0x86,0x29,0xDC,0xDD,0x59,0x02,0x20,0x70,0x47,0xE0,0x87,0xFA,0xA3,0xA6,0x11,0xBB,0x8D,0x0D,0xE1,0x98,0xCC,0xFA,0x01,0xB2,0x65,0xDC,0x0F,0x6C,0x7C,0x63,0x92,0xD8,0x48,0xAD,0x32,0xFD,0x4E,0xCB,0x1E}
这段子SCT节数据可以解析为

	单独子SCT解析状态 true

	子SCT长度：117
	LOG版本号(0: V1):0
	LogID：12F14E34BD53724C840619C38F3F7A13F8E7B56287889C6D300584EBE586263A
	时间戳:1723433542750
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：463044022042ee56f3663b32a6ddf1504781c2f217803d5c12132f4a993fe55f8629dcdd5902207047e087faa3a611bb8d0de198ccfa01b265dc0f6c7c6392d848ad32fd4ecb1e

2.例子1 SCT列表（包含3组数据）

0x01,0x67,0x00,0x75,0x00,0x12,0xF1,0x4E,0x34,0xBD,0x53,0x72,0x4C,0x84,0x06,0x19,0xC3,0x8F,0x3F,0x7A,0x13,0xF8,0xE7,0xB5,0x62,0x87,0x88,0x9C,0x6D,0x30,0x05,0x84,0xEB,0xE5,0x86,0x26,0x3A,0x00,0x00,0x01,0x91,0x44,0xA4,0xE4,0x5E,0x00,0x00,0x04,0x03,0x00,0x46,0x30,0x44,0x02,0x20,0x42,0xEE,0x56,0xF3,0x66,0x3B,0x32,0xA6,0xDD,0xF1,0x50,0x47,0x81,0xC2,0xF2,0x17,0x80,0x3D,0x5C,0x12,0x13,0x2F,0x4A,0x99,0x3F,0xE5,0x5F,0x86,0x29,0xDC,0xDD,0x59,0x02,0x20,0x70,0x47,0xE0,0x87,0xFA,0xA3,0xA6,0x11,0xBB,0x8D,0x0D,0xE1,0x98,0xCC,0xFA,0x01,0xB2,0x65,0xDC,0x0F,0x6C,0x7C,0x63,0x92,0xD8,0x48,0xAD,0x32,0xFD,0x4E,0xCB,0x1E,0x00,0x76,0x00,0xE6,0xD2,0x31,0x63,0x40,0x77,0x8C,0xC1,0x10,0x41,0x06,0xD7,0x71,0xB9,0xCE,0xC1,0xD2,0x40,0xF6,0x96,0x84,0x86,0xFB,0xBA,0x87,0x32,0x1D,0xFD,0x1E,0x37,0x8E,0x50,0x00,0x00,0x01,0x91,0x44,0xA4,0xE4,0x66,0x00,0x00,0x04,0x03,0x00,0x47,0x30,0x45,0x02,0x20,0x44,0xAA,0x14,0x26,0x63,0x6F,0x27,0x30,0xBD,0x59,0x7F,0xB0,0x65,0xDB,0xBA,0x1E,0x63,0xCE,0x35,0x02,0x5E,0x50,0x4C,0x85,0xBA,0x15,0x56,0x12,0xCA,0x15,0x8B,0xB3,0x02,0x21,0x00,0xEC,0x76,0xF8,0xB0,0x89,0x2C,0x8F,0xF4,0x59,0xCE,0xA0,0x79,0xEE,0x3A,0xFF,0xBA,0xB0,0x1C,0x47,0x0F,0x21,0xD2,0x28,0xB1,0x8F,0xD5,0x6F,0x53,0x85,0xAA,0xDF,0x7A,0x00,0x76,0x00,0xCC,0xFB,0x0F,0x6A,0x85,0x71,0x09,0x65,0xFE,0x95,0x9B,0x53,0xCE,0xE9,0xB2,0x7C,0x22,0xE9,0x85,0x5C,0x0D,0x97,0x8D,0xB6,0xA9,0x7E,0x54,0xC0,0xFE,0x4C,0x0D,0xB0,0x00,0x00,0x01,0x91,0x44,0xA4,0xE4,0x66,0x00,0x00,0x04,0x03,0x00,0x47,0x30,0x45,0x02,0x20,0x7A,0x35,0xA5,0xF3,0xB9,0x84,0xC9,0xF6,0xCD,0x2D,0xAE,0x7D,0x01,0x05,0x7A,0x45,0x04,0x2A,0x10,0x33,0x5A,0x39,0xD4,0xDC,0x10,0x81,0xC3,0x6B,0xC0,0x18,0x4D,0xA3,0x02,0x21,0x00,0x90,0x5F,0x9B,0xB6,0x79,0x2C,0x86,0xD9,0x1F,0x34,0xAE,0xA7,0x3C,0x29,0xEE,0xB2,0x85,0xFA,0x71,0x26,0xAB,0x97,0x36,0x28,0x93,0x80,0xE0,0xCD,0x6D,0x4F,0xA1,0x0C}

这段SCT列表数据可以解析为

	例子1 解析状态 true
	例子1 SCTs数据
	第0组SCT
	SCT长度：117
	LOG版本号(0: V1):0
	LogID：12F14E34BD53724C840619C38F3F7A13F8E7B56287889C6D300584EBE586263A
	时间戳:1723433542750
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：463044022042ee56f3663b32a6ddf1504781c2f217803d5c12132f4a993fe55f8629dcdd5902207047e087faa3a611bb8d0de198ccfa01b265dc0f6c7c6392d848ad32fd4ecb1e

	第1组SCT
	SCT长度：118
	LOG版本号(0: V1):0
	LogID：E6D2316340778CC1104106D771B9CEC1D240F6968486FBBA87321DFD1E378E50
	时间戳:1723433542758
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：473045022044aa1426636f2730bd597fb065dbba1e63ce35025e504c85ba155612ca158bb3022100ec76f8b0892c8ff459cea079ee3affbab01c470f21d228b18fd56f5385aadf7a

	第2组SCT
	SCT长度：118
	LOG版本号(0: V1):0
	LogID：CCFB0F6A85710965FE959B53CEE9B27C22E9855C0D978DB6A97E54C0FE4C0DB0
	时间戳:1723433542758
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：47304502207a35a5f3b984c9f6cd2dae7d01057a45042a10335a39d4dc1081c36bc0184da3022100905f9bb6792c86d91f34aea73c29eeb285fa7126ab9736289380e0cd6d4fa10c

3.例子2 SCT列表（包含3组数据）
0x01,0x67,0x00,0x75,0x00,0x3F,0x17,0x4B,0x4F,0xD7,0x22,0x47,0x58,0x94,0x1D,0x65,0x1C,0x84,0xBE,0x0D,0x12,0xED,0x90,0x37,0x7F,0x1F,0x85,0x6A,0xEB,0xC1,0xBF,0x28,0x85,0xEC,0xF8,0x64,0x6E,0x00,0x00,0x01,0x8B,0xD2,0x12,0xE5,0xD0,0x00,0x00,0x04,0x03,0x00,0x46,0x30,0x44,0x02,0x20,0x14,0x5C,0xDE,0x40,0xFC,0x54,0x35,0x46,0x53,0x73,0xB8,0x99,0xF5,0x4A,0xD7,0x9D,0xD8,0x37,0x37,0x8C,0x60,0x40,0x7B,0x99,0x35,0x01,0xE8,0xAC,0x31,0xE3,0x50,0x98,0x02,0x20,0x31,0x4E,0x87,0x6A,0xD5,0xE9,0x98,0xC5,0x8D,0xFA,0x39,0x6D,0xB1,0x45,0x86,0x0E,0xE2,0xDA,0xFC,0x34,0xAC,0xB8,0xFD,0xB9,0x59,0xB0,0x5A,0x34,0x24,0x5B,0xA4,0xBF,0x00,0x76,0x00,0xEE,0xCD,0xD0,0x64,0xD5,0xDB,0x1A,0xCE,0xC5,0x5C,0xB7,0x9D,0xB4,0xCD,0x13,0xA2,0x32,0x87,0x46,0x7C,0xBC,0xEC,0xDE,0xC3,0x51,0x48,0x59,0x46,0x71,0x1F,0xB5,0x9B,0x00,0x00,0x01,0x8B,0xD2,0x12,0xE5,0xA5,0x00,0x00,0x04,0x03,0x00,0x47,0x30,0x45,0x02,0x21,0x00,0xFD,0xC5,0x2B,0x47,0xC5,0xBA,0xD0,0x96,0x0C,0x11,0xBF,0xF5,0xC2,0x65,0x85,0xE2,0x9A,0x9A,0x2C,0xC1,0x0C,0x5A,0xAF,0xF3,0x33,0x74,0xD3,0xC9,0x4E,0xD0,0x1B,0x11,0x02,0x20,0x0A,0x46,0x46,0xCE,0x01,0x71,0xAE,0xC1,0xA8,0x84,0x75,0x7A,0x9E,0xA3,0x32,0x85,0xF4,0x75,0x84,0x57,0x9B,0x90,0x80,0x66,0x35,0x6F,0x0F,0x88,0x4C,0xA8,0x34,0xB3,0x00,0x76,0x00,0x48,0xB0,0xE3,0x6B,0xDA,0xA6,0x47,0x34,0x0F,0xE5,0x6A,0x02,0xFA,0x9D,0x30,0xEB,0x1C,0x52,0x01,0xCB,0x56,0xDD,0x2C,0x81,0xD9,0xBB,0xBF,0xAB,0x39,0xD8,0x84,0x73,0x00,0x00,0x01,0x8B,0xD2,0x12,0xE5,0xC1,0x00,0x00,0x04,0x03,0x00,0x47,0x30,0x45,0x02,0x20,0x05,0xE6,0xFE,0xEA,0xEE,0xCD,0xAA,0x4E,0x3D,0x08,0x5C,0x5A,0x50,0x4D,0x00,0x42,0x4F,0x65,0x59,0xB2,0x92,0xDA,0x86,0x2E,0xD6,0x7F,0xB4,0xD8,0x55,0x2F,0x93,0x4D,0x02,0x21,0x00,0xF7,0x98,0x79,0x55,0x84,0x90,0x7B,0xDB,0xBE,0xA0,0x5D,0xB8,0x35,0xAB,0xF2,0x7A,0x41,0x81,0x7D,0x60,0x50,0xB2,0x55,0x96,0x62,0x9D,0x08,0x7B,0x51,0x5D,0xC0,0x24}

这段SCT列表数据可以解析为

	例子2 解析状态 true
	例子2 SCTs数据
	第0组SCT
	SCT长度：117
	LOG版本号(0: V1):0
	LogID：3F174B4FD7224758941D651C84BE0D12ED90377F1F856AEBC1BF2885ECF8646E
	时间戳:1700036535760
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：4630440220145cde40fc5435465373b899f54ad79dd837378c60407b993501e8ac31e350980220314e876ad5e998c58dfa396db145860ee2dafc34acb8fdb959b05a34245ba4bf

	第1组SCT
	SCT长度：118
	LOG版本号(0: V1):0
	LogID：EECDD064D5DB1ACEC55CB79DB4CD13A23287467CBCECDEC351485946711FB59B
	时间戳:1700036535717
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：473045022100fdc52b47c5bad0960c11bff5c26585e29a9a2cc10c5aaff33374d3c94ed01b1102200a4646ce0171aec1a884757a9ea33285f47584579b908066356f0f884ca834b3

	第2组SCT
	SCT长度：118
	LOG版本号(0: V1):0
	LogID：48B0E36BDAA647340FE56A02FA9D30EB1C5201CB56DD2C81D9BBBFAB39D88473
	时间戳:1700036535745
	哈希算法(SHA256):4
	签名算法(ECDSA):3
	签名：473045022005e6feeaeecdaa4e3d085c5a504d00424f6559b292da862ed67fb4d8552f934d022100f798795584907bdbbea05db835abf27a41817d6050b25596629d087b515dc024
2024 年 10 月 6 日 16:36